---------- Begin SLURM Prolog ----------
Job ID:        7211140
Username:      siliangc
Accountname:   lc_fs3
Name:          batchrun_light.sh
Partition:     main
Nodelist:      hpc4342
TasksPerNode:  1
CPUsPerTask:   Default[1]
TMPDIR:        /tmp/7211140.main
SCRATCHDIR:    /staging/scratch/7211140
Cluster:       uschpc
HSDA Account:  false
---------- 2020-05-05 16:14:38 ---------
2020-05-05 16:16:50.428209: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-05-05 16:16:50.478051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:07:00.0 name: Tesla P100-PCIE-16GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 15.90GiB deviceMemoryBandwidth: 681.88GiB/s
2020-05-05 16:16:50.479142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 1 with properties: 
pciBusID: 0000:81:00.0 name: Tesla P100-PCIE-16GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 15.90GiB deviceMemoryBandwidth: 681.88GiB/s
2020-05-05 16:16:50.482356: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-05 16:16:50.489031: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-05 16:16:50.493641: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-05-05 16:16:50.496292: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-05-05 16:16:50.501632: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-05-05 16:16:50.506116: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-05-05 16:16:50.514147: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-05 16:16:50.518372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0, 1
2020-05-05 16:16:50.519122: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-05-05 16:16:50.532671: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2394450000 Hz
2020-05-05 16:16:50.533989: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d397e29090 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-05 16:16:50.534016: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-05-05 16:16:50.705133: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d397e930d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-05-05 16:16:50.705203: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
2020-05-05 16:16:50.705224: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (1): Tesla P100-PCIE-16GB, Compute Capability 6.0
2020-05-05 16:16:50.706847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:07:00.0 name: Tesla P100-PCIE-16GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 15.90GiB deviceMemoryBandwidth: 681.88GiB/s
2020-05-05 16:16:50.707838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 1 with properties: 
pciBusID: 0000:81:00.0 name: Tesla P100-PCIE-16GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 15.90GiB deviceMemoryBandwidth: 681.88GiB/s
2020-05-05 16:16:50.707892: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-05 16:16:50.707911: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-05 16:16:50.707931: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-05-05 16:16:50.707947: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-05-05 16:16:50.707962: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-05-05 16:16:50.707977: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-05-05 16:16:50.707993: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-05 16:16:50.712306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0, 1
2020-05-05 16:16:50.712347: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-05 16:16:50.714857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-05-05 16:16:50.714875: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 1 
2020-05-05 16:16:50.714883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N N 
2020-05-05 16:16:50.714889: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 1:   N N 
2020-05-05 16:16:50.719323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15056 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:07:00.0, compute capability: 6.0)
2020-05-05 16:16:50.720735: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 15056 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-16GB, pci bus id: 0000:81:00.0, compute capability: 6.0)
2020-05-05 16:17:02.706624: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-05 16:17:02.936716: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
Processing Data...
Processing sequences of length: 1kk

Processing forward host data...
Processing prokaryote training data from ProkTr#ProkTr#1k_num1_seq12693_codefw.npy
Processing eukaryote training data from EukTr#EukTr#1k_num1_seq11439_codefw.npy
Processing reverse host data...
Processing prokaryote training data from ProkTr#ProkTr#1k_num1_seq12693_codebw.npy
Processing eukaryote training data from EukTr#EukTr#1k_num1_seq11439_codebw.npy
Processing plasmid data
Processing plasmid data - bw
Processing virus data...
Processing prokaryotevirus training data from ProkVirusTr#ProkVirusTr#1k_num1_seq13066_codefw.npy
Processin eukaryotevirus training data from EukVirusTr#EukVirusTr#1k_num1_seq12272_codefw.npy
Processing virus data...
Processing prokaryotevirus training data from ProkVirusTr#ProkVirusTr#1k_num1_seq13066_codebw.npy
Processin eukaryotevirus training data from EukVirusTr#EukVirusTr#1k_num1_seq12272_codebw.npy
Processing Validation Data...
Processing Validation Data - bw...
(62715, 1000, 4)
(62715, 1000, 4)
(62715, 5)
(6807, 1000, 4)
(6807, 1000, 4)
(6807, 5)
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, None, 4)]    0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            [(None, None, 4)]    0                                            
__________________________________________________________________________________________________
conv1d (Conv1D)                 (None, None, 64)     1600        input_1[0][0]                    
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
max_pooling1d (MaxPooling1D)    (None, None, 64)     0           conv1d[0][0]                     
                                                                 conv1d[1][0]                     
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, None, 64)     256         max_pooling1d[0][0]              
                                                                 max_pooling1d[1][0]              
__________________________________________________________________________________________________
conv1d_1 (Conv1D)               (None, None, 128)    24704       batch_normalization[0][0]        
                                                                 batch_normalization[1][0]        
__________________________________________________________________________________________________
max_pooling1d_1 (MaxPooling1D)  (None, None, 128)    0           conv1d_1[0][0]                   
                                                                 conv1d_1[1][0]                   
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, None, 128)    512         max_pooling1d_1[0][0]            
                                                                 max_pooling1d_1[1][0]            
__________________________________________________________________________________________________
conv1d_2 (Conv1D)               (None, None, 256)    65792       batch_normalization_1[0][0]      
                                                                 batch_normalization_1[1][0]      
__________________________________________________________________________________________________
global_max_pooling1d (GlobalMax (None, 256)          0           conv1d_2[0][0]                   
                                                                 conv1d_2[1][0]                   
__________________________________________________________________________________________________
dropout (Dropout)               (None, 256)          0           global_max_pooling1d[0][0]       
                                                                 global_max_pooling1d[1][0]       
__________________________________________________________________________________________________
flatten (Flatten)               (None, 256)          0           dropout[0][0]                    
                                                                 dropout[1][0]                    
__________________________________________________________________________________________________
dense (Dense)                   (None, 500)          128500      flatten[0][0]                    
                                                                 flatten[1][0]                    
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 500)          0           dense[0][0]                      
                                                                 dense[1][0]                      
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 5)            2505        dropout_1[0][0]                  
                                                                 dropout_1[1][0]                  
__________________________________________________________________________________________________
average (Average)               (None, 5)            0           dense_1[0][0]                    
                                                                 dense_1[1][0]                    
==================================================================================================
Total params: 223,869
Trainable params: 223,485
Non-trainable params: 384
__________________________________________________________________________________________________
Epoch 1/60

Epoch 00001: val_loss improved from inf to 1.19984, saving model to ./models/model_DNA_one-hot.h5
628/628 - 20s - loss: 1.1791 - accuracy: 0.5215 - val_loss: 1.1998 - val_accuracy: 0.5015
Epoch 2/60

Epoch 00002: val_loss improved from 1.19984 to 0.92300, saving model to ./models/model_DNA_one-hot.h5
628/628 - 20s - loss: 0.9222 - accuracy: 0.6239 - val_loss: 0.9230 - val_accuracy: 0.6179
Epoch 3/60

Epoch 00003: val_loss did not improve from 0.92300
628/628 - 19s - loss: 0.8475 - accuracy: 0.6568 - val_loss: 0.9444 - val_accuracy: 0.6119
Epoch 4/60

Epoch 00004: val_loss improved from 0.92300 to 0.86543, saving model to ./models/model_DNA_one-hot.h5
628/628 - 19s - loss: 0.7897 - accuracy: 0.6835 - val_loss: 0.8654 - val_accuracy: 0.6402
Epoch 5/60

Epoch 00005: val_loss did not improve from 0.86543
628/628 - 19s - loss: 0.7251 - accuracy: 0.7094 - val_loss: 0.9298 - val_accuracy: 0.6383
Epoch 6/60

Epoch 00006: val_loss did not improve from 0.86543
628/628 - 19s - loss: 0.6512 - accuracy: 0.7439 - val_loss: 1.0827 - val_accuracy: 0.5954
Epoch 7/60

Epoch 00007: val_loss did not improve from 0.86543
628/628 - 19s - loss: 0.6073 - accuracy: 0.7597 - val_loss: 0.9431 - val_accuracy: 0.6205
Epoch 8/60

Epoch 00008: val_loss improved from 0.86543 to 0.85591, saving model to ./models/model_DNA_one-hot.h5
628/628 - 19s - loss: 0.5689 - accuracy: 0.7784 - val_loss: 0.8559 - val_accuracy: 0.6507
Epoch 9/60

Epoch 00009: val_loss improved from 0.85591 to 0.81021, saving model to ./models/model_DNA_one-hot.h5
628/628 - 19s - loss: 0.5360 - accuracy: 0.7922 - val_loss: 0.8102 - val_accuracy: 0.6725
Epoch 10/60

Epoch 00010: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.5058 - accuracy: 0.8043 - val_loss: 0.8522 - val_accuracy: 0.6731
Epoch 11/60

Epoch 00011: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.4866 - accuracy: 0.8134 - val_loss: 0.8902 - val_accuracy: 0.6639
Epoch 12/60

Epoch 00012: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.4693 - accuracy: 0.8202 - val_loss: 0.8699 - val_accuracy: 0.6834
Epoch 13/60

Epoch 00013: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.4449 - accuracy: 0.8301 - val_loss: 0.8561 - val_accuracy: 0.6802
Epoch 14/60

Epoch 00014: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.4246 - accuracy: 0.8391 - val_loss: 0.9037 - val_accuracy: 0.6696
Epoch 15/60

Epoch 00015: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.4184 - accuracy: 0.8401 - val_loss: 1.1042 - val_accuracy: 0.6368
Epoch 16/60

Epoch 00016: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.4010 - accuracy: 0.8473 - val_loss: 0.9031 - val_accuracy: 0.6897
Epoch 17/60

Epoch 00017: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.3871 - accuracy: 0.8546 - val_loss: 0.9359 - val_accuracy: 0.6690
Epoch 18/60

Epoch 00018: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.3802 - accuracy: 0.8566 - val_loss: 1.0071 - val_accuracy: 0.6643
Epoch 19/60

Epoch 00019: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.3649 - accuracy: 0.8633 - val_loss: 1.0041 - val_accuracy: 0.6696
Epoch 20/60

Epoch 00020: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.3566 - accuracy: 0.8667 - val_loss: 1.0289 - val_accuracy: 0.6758
Epoch 21/60

Epoch 00021: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.3461 - accuracy: 0.8699 - val_loss: 1.0071 - val_accuracy: 0.6601
Epoch 22/60

Epoch 00022: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.3403 - accuracy: 0.8729 - val_loss: 0.9161 - val_accuracy: 0.6965
Epoch 23/60

Epoch 00023: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.3310 - accuracy: 0.8752 - val_loss: 0.9634 - val_accuracy: 0.6916
Epoch 24/60

Epoch 00024: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.3247 - accuracy: 0.8801 - val_loss: 1.0285 - val_accuracy: 0.6866
Epoch 25/60

Epoch 00025: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.3226 - accuracy: 0.8812 - val_loss: 1.0936 - val_accuracy: 0.6903
Epoch 26/60

Epoch 00026: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.3149 - accuracy: 0.8831 - val_loss: 1.1070 - val_accuracy: 0.6764
Epoch 27/60

Epoch 00027: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.3041 - accuracy: 0.8872 - val_loss: 1.0744 - val_accuracy: 0.6792
Epoch 28/60

Epoch 00028: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.2939 - accuracy: 0.8916 - val_loss: 0.9965 - val_accuracy: 0.6909
Epoch 29/60

Epoch 00029: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.2936 - accuracy: 0.8945 - val_loss: 1.1210 - val_accuracy: 0.6822
Epoch 30/60

Epoch 00030: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.2894 - accuracy: 0.8945 - val_loss: 1.1886 - val_accuracy: 0.6775
Epoch 31/60

Epoch 00031: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.2865 - accuracy: 0.8966 - val_loss: 1.0793 - val_accuracy: 0.6919
Epoch 32/60

Epoch 00032: val_loss did not improve from 0.81021
628/628 - 19s - loss: 0.2879 - accuracy: 0.8955 - val_loss: 1.2343 - val_accuracy: 0.6693
Epoch 00032: early stopping
