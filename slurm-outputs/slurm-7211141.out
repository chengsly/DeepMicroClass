---------- Begin SLURM Prolog ----------
Job ID:        7211141
Username:      siliangc
Accountname:   lc_fs3
Name:          batchrun_light.sh
Partition:     main
Nodelist:      hpc4342
TasksPerNode:  1
CPUsPerTask:   Default[1]
TMPDIR:        /tmp/7211141.main
SCRATCHDIR:    /staging/scratch/7211141
Cluster:       uschpc
HSDA Account:  false
---------- 2020-05-05 16:30:02 ---------
2020-05-05 16:30:45.406640: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-05-05 16:30:45.448683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:07:00.0 name: Tesla P100-PCIE-16GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 15.90GiB deviceMemoryBandwidth: 681.88GiB/s
2020-05-05 16:30:45.449967: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 1 with properties: 
pciBusID: 0000:81:00.0 name: Tesla P100-PCIE-16GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 15.90GiB deviceMemoryBandwidth: 681.88GiB/s
2020-05-05 16:30:45.479238: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-05 16:30:45.537734: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-05 16:30:45.567491: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-05-05 16:30:45.596331: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-05-05 16:30:45.626404: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-05-05 16:30:45.654605: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-05-05 16:30:45.687345: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-05 16:30:45.692058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0, 1
2020-05-05 16:30:45.692615: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-05-05 16:30:45.702691: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2394450000 Hz
2020-05-05 16:30:45.704025: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fa541958b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-05 16:30:45.704052: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-05-05 16:30:45.890480: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fa541ff8d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-05-05 16:30:45.890518: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
2020-05-05 16:30:45.890526: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (1): Tesla P100-PCIE-16GB, Compute Capability 6.0
2020-05-05 16:30:45.891785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:07:00.0 name: Tesla P100-PCIE-16GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 15.90GiB deviceMemoryBandwidth: 681.88GiB/s
2020-05-05 16:30:45.892821: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 1 with properties: 
pciBusID: 0000:81:00.0 name: Tesla P100-PCIE-16GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 15.90GiB deviceMemoryBandwidth: 681.88GiB/s
2020-05-05 16:30:45.892881: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-05 16:30:45.892899: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-05 16:30:45.892918: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-05-05 16:30:45.892933: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-05-05 16:30:45.892947: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-05-05 16:30:45.892961: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-05-05 16:30:45.892976: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-05 16:30:45.897057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0, 1
2020-05-05 16:30:45.897091: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-05 16:30:45.899744: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-05-05 16:30:45.899761: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 1 
2020-05-05 16:30:45.899768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N N 
2020-05-05 16:30:45.899774: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 1:   N N 
2020-05-05 16:30:45.904016: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15056 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:07:00.0, compute capability: 6.0)
2020-05-05 16:30:45.905517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 15056 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-16GB, pci bus id: 0000:81:00.0, compute capability: 6.0)
2020-05-05 16:30:49.750866: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-05 16:30:49.976427: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
Processing Data...
Processing sequences of length: 3kk

Processing forward host data...
Processing prokaryote training data from ProkTr#ProkTr#3k_num1_seq4194_codefw.npy
Processing eukaryote training data from EukTr#EukTr#3k_num1_seq3584_codefw.npy
Processing reverse host data...
Processing prokaryote training data from ProkTr#ProkTr#3k_num1_seq4194_codebw.npy
Processing eukaryote training data from EukTr#EukTr#3k_num1_seq3584_codebw.npy
Processing plasmid data
Processing plasmid data - bw
Processing virus data...
Processing prokaryotevirus training data from ProkVirusTr#ProkVirusTr#3k_num1_seq4264_codefw.npy
Processin eukaryotevirus training data from EukVirusTr#EukVirusTr#3k_num1_seq2087_codefw.npy
Processing virus data...
Processing prokaryotevirus training data from ProkVirusTr#ProkVirusTr#3k_num1_seq4264_codebw.npy
Processin eukaryotevirus training data from EukVirusTr#EukVirusTr#3k_num1_seq2087_codebw.npy
Processing Validation Data...
Processing Validation Data - bw...
(18486, 3000, 4)
(18486, 3000, 4)
(18486, 5)
(2040, 3000, 4)
(2040, 3000, 4)
(2040, 5)
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, None, 4)]    0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            [(None, None, 4)]    0                                            
__________________________________________________________________________________________________
conv1d (Conv1D)                 (None, None, 64)     1600        input_1[0][0]                    
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
max_pooling1d (MaxPooling1D)    (None, None, 64)     0           conv1d[0][0]                     
                                                                 conv1d[1][0]                     
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, None, 64)     256         max_pooling1d[0][0]              
                                                                 max_pooling1d[1][0]              
__________________________________________________________________________________________________
conv1d_1 (Conv1D)               (None, None, 128)    24704       batch_normalization[0][0]        
                                                                 batch_normalization[1][0]        
__________________________________________________________________________________________________
max_pooling1d_1 (MaxPooling1D)  (None, None, 128)    0           conv1d_1[0][0]                   
                                                                 conv1d_1[1][0]                   
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, None, 128)    512         max_pooling1d_1[0][0]            
                                                                 max_pooling1d_1[1][0]            
__________________________________________________________________________________________________
conv1d_2 (Conv1D)               (None, None, 256)    65792       batch_normalization_1[0][0]      
                                                                 batch_normalization_1[1][0]      
__________________________________________________________________________________________________
global_max_pooling1d (GlobalMax (None, 256)          0           conv1d_2[0][0]                   
                                                                 conv1d_2[1][0]                   
__________________________________________________________________________________________________
dropout (Dropout)               (None, 256)          0           global_max_pooling1d[0][0]       
                                                                 global_max_pooling1d[1][0]       
__________________________________________________________________________________________________
flatten (Flatten)               (None, 256)          0           dropout[0][0]                    
                                                                 dropout[1][0]                    
__________________________________________________________________________________________________
dense (Dense)                   (None, 500)          128500      flatten[0][0]                    
                                                                 flatten[1][0]                    
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 500)          0           dense[0][0]                      
                                                                 dense[1][0]                      
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 5)            2505        dropout_1[0][0]                  
                                                                 dropout_1[1][0]                  
__________________________________________________________________________________________________
average (Average)               (None, 5)            0           dense_1[0][0]                    
                                                                 dense_1[1][0]                    
==================================================================================================
Total params: 223,869
Trainable params: 223,485
Non-trainable params: 384
__________________________________________________________________________________________________
Epoch 1/60

Epoch 00001: val_loss improved from inf to 1.65343, saving model to ./models/model_DNA_one-hot.h5
185/185 - 16s - loss: 1.4655 - accuracy: 0.4123 - val_loss: 1.6534 - val_accuracy: 0.3593
Epoch 2/60

Epoch 00002: val_loss improved from 1.65343 to 1.00109, saving model to ./models/model_DNA_one-hot.h5
185/185 - 15s - loss: 1.0010 - accuracy: 0.5919 - val_loss: 1.0011 - val_accuracy: 0.5765
Epoch 3/60

Epoch 00003: val_loss improved from 1.00109 to 0.91636, saving model to ./models/model_DNA_one-hot.h5
185/185 - 16s - loss: 0.8983 - accuracy: 0.6381 - val_loss: 0.9164 - val_accuracy: 0.6074
Epoch 4/60

Epoch 00004: val_loss improved from 0.91636 to 0.89512, saving model to ./models/model_DNA_one-hot.h5
185/185 - 16s - loss: 0.8193 - accuracy: 0.6749 - val_loss: 0.8951 - val_accuracy: 0.6157
Epoch 5/60

Epoch 00005: val_loss improved from 0.89512 to 0.82174, saving model to ./models/model_DNA_one-hot.h5
185/185 - 16s - loss: 0.7777 - accuracy: 0.6936 - val_loss: 0.8217 - val_accuracy: 0.6441
Epoch 6/60

Epoch 00006: val_loss improved from 0.82174 to 0.80654, saving model to ./models/model_DNA_one-hot.h5
185/185 - 16s - loss: 0.7346 - accuracy: 0.7093 - val_loss: 0.8065 - val_accuracy: 0.6647
Epoch 7/60

Epoch 00007: val_loss improved from 0.80654 to 0.80314, saving model to ./models/model_DNA_one-hot.h5
185/185 - 15s - loss: 0.7091 - accuracy: 0.7201 - val_loss: 0.8031 - val_accuracy: 0.6588
Epoch 8/60

Epoch 00008: val_loss did not improve from 0.80314
185/185 - 15s - loss: 0.6648 - accuracy: 0.7412 - val_loss: 0.8043 - val_accuracy: 0.6750
Epoch 9/60

Epoch 00009: val_loss improved from 0.80314 to 0.80091, saving model to ./models/model_DNA_one-hot.h5
185/185 - 16s - loss: 0.6303 - accuracy: 0.7546 - val_loss: 0.8009 - val_accuracy: 0.6770
Epoch 10/60

Epoch 00010: val_loss improved from 0.80091 to 0.77014, saving model to ./models/model_DNA_one-hot.h5
185/185 - 15s - loss: 0.6004 - accuracy: 0.7666 - val_loss: 0.7701 - val_accuracy: 0.7005
Epoch 11/60

Epoch 00011: val_loss improved from 0.77014 to 0.74114, saving model to ./models/model_DNA_one-hot.h5
185/185 - 16s - loss: 0.5562 - accuracy: 0.7876 - val_loss: 0.7411 - val_accuracy: 0.7167
Epoch 12/60

Epoch 00012: val_loss improved from 0.74114 to 0.71403, saving model to ./models/model_DNA_one-hot.h5
185/185 - 16s - loss: 0.5165 - accuracy: 0.8068 - val_loss: 0.7140 - val_accuracy: 0.7108
Epoch 13/60

Epoch 00013: val_loss improved from 0.71403 to 0.67366, saving model to ./models/model_DNA_one-hot.h5
185/185 - 16s - loss: 0.4762 - accuracy: 0.8203 - val_loss: 0.6737 - val_accuracy: 0.7289
Epoch 14/60

Epoch 00014: val_loss did not improve from 0.67366
185/185 - 15s - loss: 0.4288 - accuracy: 0.8380 - val_loss: 0.7176 - val_accuracy: 0.7044
Epoch 15/60

Epoch 00015: val_loss did not improve from 0.67366
185/185 - 15s - loss: 0.3776 - accuracy: 0.8638 - val_loss: 0.6883 - val_accuracy: 0.7162
Epoch 16/60

Epoch 00016: val_loss did not improve from 0.67366
185/185 - 15s - loss: 0.3542 - accuracy: 0.8673 - val_loss: 0.7279 - val_accuracy: 0.7250
Epoch 17/60

Epoch 00017: val_loss did not improve from 0.67366
185/185 - 15s - loss: 0.3440 - accuracy: 0.8744 - val_loss: 0.8371 - val_accuracy: 0.6951
Epoch 18/60

Epoch 00018: val_loss did not improve from 0.67366
185/185 - 15s - loss: 0.2963 - accuracy: 0.8945 - val_loss: 0.7877 - val_accuracy: 0.7118
Epoch 19/60

Epoch 00019: val_loss did not improve from 0.67366
185/185 - 15s - loss: 0.2792 - accuracy: 0.9002 - val_loss: 0.7717 - val_accuracy: 0.7152
Epoch 20/60

Epoch 00020: val_loss did not improve from 0.67366
185/185 - 15s - loss: 0.2601 - accuracy: 0.9078 - val_loss: 0.7877 - val_accuracy: 0.7108
Epoch 21/60

Epoch 00021: val_loss did not improve from 0.67366
185/185 - 15s - loss: 0.2379 - accuracy: 0.9156 - val_loss: 0.7603 - val_accuracy: 0.7289
Epoch 22/60

Epoch 00022: val_loss did not improve from 0.67366
185/185 - 15s - loss: 0.2237 - accuracy: 0.9241 - val_loss: 0.8750 - val_accuracy: 0.7029
Epoch 23/60

Epoch 00023: val_loss did not improve from 0.67366
185/185 - 15s - loss: 0.2152 - accuracy: 0.9271 - val_loss: 0.8287 - val_accuracy: 0.7010
Epoch 00023: early stopping
