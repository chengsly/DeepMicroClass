import numpy as np
from matplotlib import pyplot as plt
import pandas as pd

plasflow_acc = [0.8631368631368631, 0.834, 0.847, 0.82, 0.818, 0.8391608391608392, 0.828, 0.818, 0.8068068068068068, 0.8028028028028028, 0.802, 0.762, 0.791, 0.785, 0.791, 0.778, 0.7407407407407407, 0.7472527472527473, 0.753, 0.77,]
plasflow_f1 = [0.6140845070422535, 0.6047619047619048, 0.6592427616926503, 0.6819787985865725, 0.5027322404371585, 0.554016620498615, 0.5845410628019324, 0.6176470588235294, 0.3949843260188088, 0.4119402985074627, 0.4530386740331492, 0.4516129032258065, 0.23443223443223443, 0.2996742671009772, 0.32362459546925565, 0.3583815028901734, 0.08480565371024734, 0.09964412811387902, 0.10830324909747291, 0.16058394160583941,]

ppr_acc = [0.8841158841158842, 0.871, 0.851, 0.867, 0.799, 0.7992007992007992, 0.804, 0.835, 0.7337337337337337, 0.7217217217217218, 0.753, 0.761, 0.678, 0.674, 0.688, 0.728, 0.6366366366366366, 0.6263736263736264, 0.663, 0.672,]
ppr_f1 = [0.6526946107784432, 0.6750629722921915, 0.657471264367816, 0.7407407407407408, 0.4523160762942779, 0.4911392405063292, 0.5355450236966824, 0.6420824295010847, 0.30729166666666663, 0.32195121951219513, 0.4019370460048426, 0.46532438478747196, 0.17857142857142858, 0.20098039215686272, 0.2352941176470588, 0.32338308457711445, 0.06683804627249358, 0.065, 0.08672086720867207, 0.10869565217391304,]

dmf_acc = [0.9590409590409591, 0.957, 0.953, 0.965, 0.973, 0.9590409590409591, 0.972, 0.958, 0.972972972972973, 0.9669669669669669, 0.978, 0.971, 0.987, 0.987, 0.985, 0.98, 0.996996996996997, 0.9920079920079921, 0.994, 0.987,]
dmf_f1 = [0.8540925266903914, 0.8700906344410876, 0.8746666666666666, 0.9234135667396062, 0.8767123287671232, 0.8416988416988417, 0.904109589041096, 0.8846153846153846, 0.8280254777070063, 0.8114285714285713, 0.8971962616822429, 0.888888888888889, 0.8571428571428572, 0.8849557522123894, 0.8799999999999999, 0.8734177215189873, 0.9032258064516129, 0.7777777777777778, 0.8636363636363635, 0.7868852459016393,]

plasflow_acc = np.array(plasflow_acc)
plasflow_f1 = np.array(plasflow_f1)
ppr_acc = np.array(ppr_acc)
ppr_f1 = np.array(ppr_f1)
dmf_acc = np.array(dmf_acc)
dmf_f1 = np.array(dmf_f1)

xticks = [f'DS_{i}' for i in range(1, 21)]

acc_df = pd.DataFrame(columns=['PlasFlow', 'PPR', 'DMF'], index=xticks)
acc_df['PlasFlow'] = plasflow_acc
acc_df['PPR'] = ppr_acc
acc_df['DMF'] = dmf_acc

ax = acc_df.plot(kind='bar',
    width=0.8,
)
plt.xticks(rotation=45)
ax.legend(loc='lower left')
ax.grid(axis='y')
ax.set_axisbelow(True)
ax.margins(0.01)
plt.savefig('figures/plasmid_acc.pdf')

f1_df = pd.DataFrame(columns=['PlasFlow', 'PPR', 'DMF'], index=xticks)
f1_df['PlasFlow'] = plasflow_f1
f1_df['PPR'] = ppr_f1
f1_df['DMF'] = dmf_f1

ax = f1_df.plot(kind='bar',
    width=0.8, 
)
ax.set_ylim(top=1)
plt.xticks(rotation=45)
ax.legend(loc='lower left')
ax.grid(axis='y')
ax.set_axisbelow(True)
ax.margins(0.01)
plt.savefig('figures/plasmid_f1.pdf')
