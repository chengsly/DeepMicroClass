import numpy as np
from matplotlib import pyplot as plt
import pandas as pd

dvf_acc = [0.8261738261738262, 0.85, 0.846, 0.831, 0.783, 0.7862137862137862, 0.771, 0.757, 0.6916916916916916, 0.7027027027027027, 0.707, 0.677, 0.672, 0.614, 0.621, 0.589, 0.5495495495495496, 0.5694305694305695, 0.53, 0.511,]
dvf_f1 = [0.5693069306930693, 0.6527777777777778, 0.6956521739130433, 0.7169179229480738, 0.4615384615384616, 0.5158371040723982, 0.5354969574036511, 0.5759162303664922, 0.28703703703703703, 0.3295711060948081, 0.3983572895277207, 0.4323374340949034, 0.19607843137254902, 0.20247933884297523, 0.2217659137577002, 0.2621184919210054, 0.05857740585774059, 0.07311827956989246, 0.07843137254901959, 0.0893854748603352,]

vibrant_acc = [0.9790209790209791, 0.982, 0.976, 0.969, 0.975, 0.9790209790209791, 0.977, 0.97, 0.977977977977978, 0.986986986986987, 0.983, 0.983, 0.991, 0.991, 0.982, 0.982, 0.994994994994995, 0.9920079920079921, 0.987, 0.987,]
vibrant_f1 = [0.924187725631769, 0.9433962264150945, 0.9365079365079364, 0.9339019189765458, 0.8837209302325583, 0.9149797570850202, 0.9230769230769231, 0.9184782608695652, 0.8641975308641977, 0.9248554913294798, 0.9209302325581394, 0.9348659003831418, 0.9052631578947368, 0.9174311926605504, 0.8676470588235294, 0.8902439024390245, 0.8484848484848484, 0.8095238095238095, 0.7547169811320755, 0.7936507936507937,]

ppr_acc = [0.9200799200799201, 0.924, 0.916, 0.914, 0.832, 0.8471528471528471, 0.842, 0.832, 0.7727727727727728, 0.7737737737737738, 0.765, 0.727, 0.688, 0.691, 0.674, 0.653, 0.6136136136136137, 0.5994005994005994, 0.549, 0.551,]
ppr_f1 = [0.7619047619047619, 0.7967914438502673, 0.8090909090909091, 0.8389513108614232, 0.5434782608695653, 0.6046511627906976, 0.6376146788990826, 0.6731517509727627, 0.3814713896457766, 0.41752577319587625, 0.45977011494252873, 0.4760076775431862, 0.21212121212121213, 0.24449877750611246, 0.26244343891402716, 0.29898989898989903, 0.0676328502415459, 0.07816091954022987, 0.0814663951120163, 0.10020040080160322,]

virsorter_acc = [0.955044955044955, 0.964, 0.957, 0.942, 0.955, 0.9440559440559441, 0.964, 0.958, 0.955955955955956, 0.955955955955956, 0.953, 0.944, 0.962, 0.966, 0.953, 0.955, 0.9669669669669669, 0.9560439560439561, 0.958, 0.948,]
virsorter_f1 = [0.8615384615384616, 0.9042553191489361, 0.9024943310657596, 0.8960573476702509, 0.8656716417910447, 0.8556701030927836, 0.9207048458149779, 0.9265734265734266, 0.8705882352941178, 0.8829787234042553, 0.8984881209503239, 0.9044368600682594, 0.8875739644970413, 0.9128205128205129, 0.9018789144050104, 0.926829268292683, 0.9020771513353116, 0.8910891089108911, 0.9156626506024097, 0.9192546583850931,]

dmf_acc = [0.988011988011988, 0.987, 0.988, 0.988, 0.985, 0.985014985014985, 0.992, 0.984, 0.98998998998999, 0.990990990990991, 0.996, 0.989, 0.997, 0.993, 0.989, 0.989, 0.995995995995996, 0.996003996003996, 0.993, 0.994,]
dmf_f1 = [0.959731543624161, 0.9618768328445748, 0.9705882352941176, 0.9768339768339768, 0.9501661129568105, 0.9575070821529744, 0.9815668202764977, 0.9705882352941176, 0.9681528662420381, 0.9754768392370572, 0.9911111111111112, 0.9811965811965812, 0.9905956112852665, 0.9817232375979114, 0.9765458422174841, 0.9819376026272577, 0.9876543209876543, 0.9897959183673469, 0.9856850715746422, 0.9906832298136645,]

dmf_prok_acc = [0.989010989010989, 0.987, 0.989, 0.986, 0.985, 0.987012987012987, 0.993, 0.984, 0.990990990990991, 0.993993993993994, 0.994, 0.991, 0.998, 0.997, 0.99, 0.991, 1.0, 0.998001998001998, 0.996, 0.999,]
dmf_prok_f1 = [0.9581749049429658, 0.9570957095709571, 0.9693593314763231, 0.9688888888888889, 0.9261083743842364, 0.944206008583691, 0.9752650176678446, 0.9534883720930233, 0.9387755102040817, 0.963855421686747, 0.9702970297029702, 0.9644268774703557, 0.9767441860465116, 0.970873786407767, 0.9180327868852459, 0.9395973154362416, 1.0, 0.9444444444444444, 0.9047619047619048, 0.9803921568627451,]

dvf_acc = np.array(dvf_acc)
dvf_f1 = np.array(dvf_f1)
vibrant_acc = np.array(vibrant_acc)
vibrant_f1 = np.array(vibrant_f1)
ppr_acc = np.array(ppr_acc)
ppr_f1 = np.array(ppr_f1)
virsorter_acc = np.array(virsorter_acc)
virsorter_f1 = np.array(virsorter_f1)
dmf_acc = np.array(dmf_acc)
dmf_f1 = np.array(dmf_f1)
dmf_prok_acc = np.array(dmf_prok_acc)
dmf_prok_f1 = np.array(dmf_prok_f1)

xticks = [f'DS_{i}' for i in range(1, 21)]

acc_df = pd.DataFrame(columns=['DMF', 'DVF', 'VIBRANT', 'PPR'], index=xticks)
acc_df['DMF'] = dmf_acc
acc_df['DVF'] = dvf_acc
acc_df['VIBRANT'] = vibrant_acc
acc_df['PPR'] = ppr_acc

ax = acc_df.plot(kind='bar',
    width=0.8,
)
ax.set_ylabel("Accuracy")
plt.xticks(rotation=45)
ax.set_ylim(top=1)
ax.legend(loc='lower left')
ax.grid(axis='y')
ax.set_axisbelow(True)
ax.margins(0.01)
plt.savefig('figures/prok_vir_acc.pdf', bbox_inches='tight')

f1_df = pd.DataFrame(columns=['DMF', 'DVF', 'VIBRANT', 'PPR'], index=xticks)
f1_df['DMF'] = dmf_f1
f1_df['DVF'] = dvf_f1
f1_df['VIBRANT'] = vibrant_f1
f1_df['PPR'] = ppr_f1

ax = f1_df.plot(kind='bar',
    width=0.8, 
)
ax.set_ylabel("F1 Score")
plt.xticks(rotation=45)
ax.set_ylim(top=1)
ax.legend(loc='lower left')
ax.grid(axis='y')
ax.set_axisbelow(True)
ax.margins(0.01)
plt.savefig('figures/prok_vir_f1.pdf', bbox_inches='tight')

acc_df = pd.DataFrame(columns=['DMF', 'VirSorter2'], index=xticks)
acc_df['DMF'] = dmf_prok_acc
acc_df['VirSorter2'] = virsorter_acc

ax = acc_df.plot(kind='bar',
    width=0.8,
)
ax.set_ylabel("Accuracy")
plt.xticks(rotation=45)
ax.set_ylim(top=1)
ax.legend(loc='lower left')
ax.grid(axis='y')
ax.set_axisbelow(True)
ax.margins(0.01)
plt.savefig('figures/vir_acc.pdf', bbox_inches='tight')

f1_df = pd.DataFrame(columns=['DMF', 'VirSorter2'], index=xticks)
f1_df['DMF'] = dmf_prok_f1
f1_df['VirSorter2'] = virsorter_f1

ax.set_ylabel("F1 Score")
plt.xticks(rotation=45)
ax.set_ylim(top=1)
ax.legend(loc='lower left')
ax.grid(axis='y')
ax.set_axisbelow(True)
ax.margins(0.01)
plt.savefig('figures/vir_f1.pdf', bbox_inches='tight')